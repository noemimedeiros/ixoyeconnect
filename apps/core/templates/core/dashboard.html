{% extends "layouts/base.html" %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/main.css' %}">
<link rel="stylesheet" href="{% static 'css/responsive.css' %}">
{% block style %}{% endblock style %}
{% if form %}
{{ form.media }}
{% endif %}

{% endblock css %}

{% block content %}
<section class="main-dashboard">
    {% include "core/partials/_navbar.html" %}
    <section class="dashboard-content">
        {% include "core/partials/_topnav.html" %}
        <div class="dashboard-card">
            <div class="dashboard-head">
                <h3><b>{% block app_title %}{% endblock app_title %}</b></h3>
                <div class="dashboard-head-actions">
                    {% block dashboard_actions %}
                    {% endblock dashboard_actions %}
                </div>
            </div>
            {% block dashboard_content %}{% endblock dashboard_content %}
        </div>
    </section>
</section>
{% endblock content %}

{% block scripts %}
<script>
    function menu_collapse(){
        let collapsed = $('.side-nav').toggleClass("collapsed");
        if ($('.side-nav').hasClass('collapsed')){
            $('.side-nav-subitem a').tooltip('enable')
        }else{
            $('.side-nav-subitem a').tooltip('disable')
        }
        if (window.innerWidth <= 768) {
            if($('#overlay-sidenav').length > 0){
                $('#overlay-sidenav').remove()
            }else{
                if($('.side-nav').hasClass('collapsed')){
                    $('body').append('<div id="overlay-sidenav" class="overlay-sidenav fade show" onclick="menu_collapse()"></div>')
                }
            }
        }
    };

    $(function(){
        $('.item-actions').each(function () {
            $(this).popover({
                content: `
                    <div class="item-actions-popover">
                        <a href="${$(this).data('editlink')}"><i class="fa-solid fa-pen-to-square"></i> <span>Editar</span> </a>
                        <a href="${$(this).data('deletelink')}"><i class="fa-solid fa-trash-can text-danger"></i> <span>Excluir</span> </a>
                    </div>
                `,
                html: true,
                placement: 'left',
                trigger: 'click',

            })
        });

        $("[data-bs-toggle='tooltip']").tooltip()
        $('.side-nav-subitem a').tooltip('disable')
    });

    function fotoPreview(input_id, foto_preview='#foto-preview'){
        try{
            const input = document.getElementById(input_id);
            const file = input.files;
            if (file && file[0] && input_id) {
                const fileReader = new FileReader();
                const preview = document.querySelector(foto_preview);
                fileReader.onload = function (event) {
                    preview.setAttribute('src', event.target.result);
                }
                fileReader.readAsDataURL(file[0]);
            }
        }catch(e){
            console.log(e)
        }
    }
</script>
{% block _scripts %}{% endblock _scripts %}
{% endblock scripts %}